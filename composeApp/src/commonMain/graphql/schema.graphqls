"""Exposes a URL that specifies the behavior of this scalar."""
directive @specifiedBy(
  """The URL that specifies the behavior of this scalar."""
  url: String!
) on SCALAR

"""Indicates an Input Object is a OneOf Input Object."""
directive @oneOf on INPUT_OBJECT

input AiAssistantChatInput {
  """The user message/query to send"""
  message: String!

  """Session ID for conversation context"""
  sessionId: String!
}

type AiAssistantOutputType {
  """Type of response (e.g., 'payment_method', 'products', 'branches')"""
  type: String!

  """AI-generated response text"""
  AItext: String!

  """List of relevant IDs (for debugging)"""
  ids: [String!]!

  """List of resolved entities (products, branches, or payment methods)"""
  entities: [EntityType!]
}

type AiAssistantResponseType {
  """Response output from AI assistant"""
  output: AiAssistantOutputType!
}

type AuthResponse {
  accessToken: String!
  tokenType: String!
  user: UserData!
}

type BranchType {
  id: String!
  businessId: String!
  name: String!
  address: String!
  coordinates: CoordinatesType!
  phone: String!
  schedule: JSON!
  managerIds: [String!]!
  status: String!
  createdAt: DateTime!
}

type BusinessType {
  id: String!
  name: String!
  type: String!
  ownerId: String!
  globalRating: Float!
  createdAt: DateTime!
}

type CategoryType {
  id: String!
  name: String!
  imageUrl: String!
  subcategories: [SubcategoryType!]!
  createdAt: DateTime!
}

type CoordinatesType {
  type: String!
  coordinates: [Float!]!
}

"""Date with time (isoformat)"""
scalar DateTime

union EntityType = ProductType | BranchType | PaymentMethodType

"""
The `JSON` scalar type represents JSON values as specified by [ECMA-404](https://ecma-international.org/wp-content/uploads/ECMA-404_2nd_edition_december_2017.pdf).
"""
scalar JSON

input LoginInput {
  email: String!
  password: String!
}

type Mutation {
  """Register a new user"""
  register(input: RegisterInput!): AuthResponse!

  """Login with email and password"""
  login(input: LoginInput!): AuthResponse!
}

type PaymentMethodType {
  """Payment method ID"""
  id: String!

  """Currency (e.g., CUP, USD)"""
  currency: String!

  """Payment method (e.g., tarjeta, efectivo, transferencia)"""
  method: String!
}

type ProductType {
  id: String!
  branchId: String!
  name: String!
  description: String!
  weight: String!
  price: Float!
  currency: String!
  image: String!
  availability: Boolean!
  categoryId: String
  createdAt: DateTime!
}

type Query {
  """Lista de usuarios"""
  users: [UserType!]!

  """Obtener usuario por ID"""
  user(id: String!): UserType

  """Buscar usuarios"""
  searchUsers(query: String!): [UserType!]!

  """Lista de negocios"""
  businesses(ownerId: String = null): [BusinessType!]!

  """Obtener negocio por ID"""
  business(id: String!): BusinessType

  """Buscar negocios"""
  searchBusinesses(query: String!): [BusinessType!]!

  """Lista de sucursales"""
  branches(businessId: String = null): [BranchType!]!

  """Obtener sucursal por ID"""
  branch(id: String!): BranchType

  """Buscar sucursales"""
  searchBranches(query: String!, limit: Int! = 10, useVectorSearch: Boolean! = true): [BranchType!]!

  """Lista de productos"""
  products(ids: [String!] = null, branchId: String = null, categoryId: String = null, availableOnly: Boolean! = false): [ProductType!]!

  """Obtener producto por ID"""
  product(id: String!): ProductType

  """Buscar productos"""
  searchProducts(query: String!, limit: Int! = 10, useVectorSearch: Boolean! = true): [ProductType!]!

  """Lista de categorías con subcategorías"""
  categories: [CategoryType!]!

  """Obtener categoría por ID"""
  category(id: String!): CategoryType

  """Send a message to the AI assistant and get a response"""
  aiChat(input: AiAssistantChatInput!): AiAssistantResponseType

  """Saludo de ejemplo"""
  hello: String!

  """Saluda por nombre"""
  greet(name: String! = "mundo"): String!
}

input RegisterInput {
  name: String!
  email: String!
  password: String!
  phone: String = null
  role: String = "customer"
}

type SubcategoryType {
  name: String!
  imageUrl: String!
}

type UserData {
  id: String!
  name: String!
  email: String!
  phone: String
  role: String!
  createdAt: String!
}

type UserType {
  id: String!
  name: String!
  email: String!
  role: String!
  createdAt: DateTime!
}

